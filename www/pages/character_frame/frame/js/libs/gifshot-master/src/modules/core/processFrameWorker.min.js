define(["dependencies/NeuQuant"],function(e){var t=function(){try{self.onmessage=function(e){var i,t=e.data||{};t.gifshot&&(i=s.run(t),postMessage(i))}}catch(t){}var s={dataToRGB:function(e,t,s){for(var i=0,n=t*s*4,a=[];n>i;)a.push(e[i++]),a.push(e[i++]),a.push(e[i++]),i++;return a},componentizedPaletteToArray:function(e){var s,i,n,a,t=[];for(s=0;s<e.length;s+=3)i=e[s],n=e[s+1],a=e[s+2],t.push(i<<16|n<<8|a);return t},processFrameWithQuantizer:function(t,s,i,n){var c,u,p,f,a=this.dataToRGB(t,s,i),r=new e(a,a.length,n),o=r.process(),h=new Uint32Array(this.componentizedPaletteToArray(o)),A=s*i,g=new Uint8Array(A),l=0;for(c=0;A>c;c++)u=a[l++],p=a[l++],f=a[l++],g[c]=r.map(u,p,f);return{pixels:g,palette:h}},run:function(e){var t=e.width,s=e.height,i=e.data,a=(e.palette,e.sampleInterval);return this.processFrameWithQuantizer(i,t,s,a)}};return s};return t});