define(["core/utils","core/AnimatedGIF","core/getBase64GIF","core/error"],function(e,t,s,i){return function(n){function f(){e.each(l,function(e,t){t&&p.addFrame(t,h)}),s(p,o)}var u,p,a=n.images,r=n.imagesLength,o=n.callback,h=n.options,A={getUserMedia:!0,"window.URL":!0},g=i.validate(A),l=[],c=0;return g.error?o(g):(p=new t(h),void e.each(a,function(t,s){e.isElement(s)?(h.crossOrigin&&(s.crossOrigin=h.crossOrigin),l[t]=s,c+=1,c===r&&f()):e.isString(s)&&(u=document.createElement("img"),h.crossOrigin&&(u.crossOrigin=h.crossOrigin),u.onerror=function(e){l.length>t&&(l[t]=void 0)}(function(s){s.onload=function(){l[t]=s,c+=1,c===r&&f(),e.removeElement(s)}}(u)),u.src=s,e.setCSSAttr(u,{position:"fixed",opacity:"0"}),document.body.appendChild(u))}))}});