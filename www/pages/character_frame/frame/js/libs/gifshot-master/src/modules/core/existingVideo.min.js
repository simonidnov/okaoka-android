define(["core/utils","core/createAndGetGIF","core/videoStream","core/error"],function(e,t,s,i){return function(n){var l,c,a=n.existingVideo,r=n.callback,o=n.options,h={getUserMedia:!0,"window.URL":!0},A=i.validate(h);if(A.error)return r(A);if(e.isElement(a)&&a.src){if(c=a.src,l=e.getExtension(c),!e.isSupported.videoCodecs[l])return r(i.messages.videoCodecs)}else e.isArray(a)&&e.each(a,function(t,s){return l=s.substr(s.lastIndexOf(".")+1,s.length),e.isSupported.videoCodecs[l]?(a=s,!1):void 0});s.startStreaming({completed:function(e){e.options=o||{},t(e,r)},existingVideo:a,crossOrigin:o.crossOrigin,options:o})}});