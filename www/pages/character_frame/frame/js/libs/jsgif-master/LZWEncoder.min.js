LZWEncoder=function(){var s,i,n,a,r,o,g,c,Q,v,y,I,e={},t=-1,h=12,A=5003,l=h,u=1<<h,p=[],f=[],d=A,_=0,m=!1,w=0,B=0,b=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],E=[],T=e.LZWEncoder=function(e,t,r,o){s=e,i=t,n=r,a=Math.max(2,o)},C=function(e,t){E[I++]=e,I>=254&&k(t)},x=function(e){S(d),_=v+2,m=!0,P(v,e)},S=function(e){for(var t=0;e>t;++t)p[t]=-1},F=e.compress=function(e,s){var i,n,a,r,o,h,A;for(Q=e,m=!1,g=Q,c=L(g),v=1<<e-1,y=v+1,_=v+2,I=0,r=j(),A=0,i=d;65536>i;i*=2)++A;A=8-A,h=d,S(h),P(v,s);e:for(;(a=j())!=t;)if(i=(a<<l)+r,n=a<<A^r,p[n]!=i){if(p[n]>=0){o=h-n,0===n&&(o=1);do if((n-=o)<0&&(n+=h),p[n]==i){r=f[n];continue e}while(p[n]>=0)}P(r,s),r=a,u>_?(f[n]=_++,p[n]=i):x(s)}else r=f[n];P(r,s),P(y,s)},k=(e.encode=function(e){e.writeByte(a),r=s*i,o=0,F(a+1,e),e.writeByte(0)},function(e){I>0&&(e.writeByte(I),e.writeBytes(E,0,I),I=0)}),L=function(e){return(1<<e)-1},j=function(){if(0===r)return t;--r;var e=n[o++];return 255&e},P=function(e,t){for(w&=b[B],B>0?w|=e<<B:w=e,B+=g;B>=8;)C(255&w,t),w>>=8,B-=8;if((_>c||m)&&(m?(c=L(g=Q),m=!1):(++g,c=g==l?u:L(g))),e==y){for(;B>0;)C(255&w,t),w>>=8,B-=8;k(t)}};return T.apply(this,arguments),e};