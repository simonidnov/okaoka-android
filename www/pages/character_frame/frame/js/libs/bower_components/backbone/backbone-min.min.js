!function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(s,i,n){t.Backbone=e(t,n,s,i)});else if("undefined"!=typeof exports){var i,s=require("underscore");try{i=require("jquery")}catch(n){}e(t,exports,s,i)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}(function(e,t,s,i){var n=e.Backbone,a=Array.prototype.slice;t.VERSION="1.3.3",t.$=i,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var r=function(e,t,i){switch(e){case 1:return function(){return s[t](this[i])};case 2:return function(e){return s[t](this[i],e)};case 3:return function(e,n){return s[t](this[i],h(e,this),n)};case 4:return function(e,n,a){return s[t](this[i],h(e,this),n,a)};default:return function(){var e=a.call(arguments);return e.unshift(this[i]),s[t].apply(s,e)}}},o=function(e,t,i){s.each(t,function(t,n){s[n]&&(e.prototype[n]=r(t,n,i))})},h=function(e,t){return s.isFunction(e)?e:s.isObject(e)&&!t._isModel(e)?A(e):s.isString(e)?function(t){return t.get(e)}:e},A=function(e){var t=s.matches(e);return function(e){return t(e.attributes)}},g=t.Events={},l=/\s+/,c=function(e,t,i,n,a){var o,r=0;if(i&&"object"==typeof i){void 0!==n&&"context"in a&&void 0===a.context&&(a.context=n);for(o=s.keys(i);r<o.length;r++)t=c(e,t,o[r],i[o[r]],a)}else if(i&&l.test(i))for(o=i.split(l);r<o.length;r++)t=e(t,o[r],n,a);else t=e(t,i,n,a);return t};g.on=function(e,t,s){return u(this,e,t,s)};var u=function(e,t,s,i,n){if(e._events=c(p,e._events||{},t,s,{context:i,ctx:e,listening:n}),n){var a=e._listeners||(e._listeners={});a[n.id]=n}return e};g.listenTo=function(e,t,i){if(!e)return this;var n=e._listenId||(e._listenId=s.uniqueId("l")),a=this._listeningTo||(this._listeningTo={}),r=a[n];if(!r){var o=this._listenId||(this._listenId=s.uniqueId("l"));r=a[n]={obj:e,objId:n,id:o,listeningTo:a,count:0}}return u(e,t,i,this,r),this};var p=function(e,t,s,i){if(s){var n=e[t]||(e[t]=[]),a=i.context,r=i.ctx,o=i.listening;o&&o.count++,n.push({callback:s,context:a,ctx:a||r,listening:o})}return e};g.off=function(e,t,s){return this._events?(this._events=c(f,this._events,e,t,{context:s,listeners:this._listeners}),this):this},g.stopListening=function(e,t,i){var n=this._listeningTo;if(!n)return this;for(var a=e?[e._listenId]:s.keys(n),r=0;r<a.length;r++){var o=n[a[r]];if(!o)break;o.obj.off(t,i,this)}return this};var f=function(e,t,i,n){if(e){var r,a=0,o=n.context,h=n.listeners;if(t||i||o){for(var g=t?[t]:s.keys(e);a<g.length;a++){t=g[a];var l=e[t];if(!l)break;for(var c=[],u=0;u<l.length;u++){var p=l[u];i&&i!==p.callback&&i!==p.callback._callback||o&&o!==p.context?c.push(p):(r=p.listening,r&&0===--r.count&&(delete h[r.id],delete r.listeningTo[r.objId]))}c.length?e[t]=c:delete e[t]}return e}for(var A=s.keys(h);a<A.length;a++)r=h[A[a]],delete h[r.id],delete r.listeningTo[r.objId]}};g.once=function(e,t,i){var n=c(d,{},e,t,s.bind(this.off,this));return"string"==typeof e&&null==i&&(t=void 0),this.on(n,t,i)},g.listenToOnce=function(e,t,i){var n=c(d,{},t,i,s.bind(this.stopListening,this,e));return this.listenTo(e,n)};var d=function(e,t,i,n){if(i){var a=e[t]=s.once(function(){n(t,a),i.apply(this,arguments)});a._callback=i}return e};g.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),s=Array(t),i=0;t>i;i++)s[i]=arguments[i+1];return c(_,this._events,e,void 0,s),this};var _=function(e,t,s,i){if(e){var n=e[t],a=e.all;n&&a&&(a=a.slice()),n&&m(n,i),a&&m(a,[t].concat(i))}return e},m=function(e,t){var s,i=-1,n=e.length,a=t[0],r=t[1],o=t[2];switch(t.length){case 0:for(;++i<n;)(s=e[i]).callback.call(s.ctx);return;case 1:for(;++i<n;)(s=e[i]).callback.call(s.ctx,a);return;case 2:for(;++i<n;)(s=e[i]).callback.call(s.ctx,a,r);return;case 3:for(;++i<n;)(s=e[i]).callback.call(s.ctx,a,r,o);return;default:for(;++i<n;)(s=e[i]).callback.apply(s.ctx,t);return}};g.bind=g.on,g.unbind=g.off,s.extend(t,g);var Q=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=s.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{});var n=s.result(this,"defaults");i=s.defaults(s.extend({},n,i),n),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};s.extend(Q.prototype,g,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return s.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return s.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!s.iteratee(e,this)(this.attributes)},set:function(e,t,i){if(null==e)return this;var n;if("object"==typeof e?(n=e,i=t):(n={})[e]=t,i||(i={}),!this._validate(n,i))return!1;var a=i.unset,r=i.silent,o=[],h=this._changing;this._changing=!0,h||(this._previousAttributes=s.clone(this.attributes),this.changed={});var A=this.attributes,g=this.changed,l=this._previousAttributes;for(var c in n)t=n[c],s.isEqual(A[c],t)||o.push(c),s.isEqual(l[c],t)?delete g[c]:g[c]=t,a?delete A[c]:A[c]=t;if(this.idAttribute in n&&(this.id=this.get(this.idAttribute)),!r){o.length&&(this._pending=i);for(var u=0;u<o.length;u++)this.trigger("change:"+o[u],this,A[o[u]],i)}if(h)return this;if(!r)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,s.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,s.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!s.isEmpty(this.changed):s.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?s.clone(this.changed):!1;var t=this._changing?this._previousAttributes:this.attributes,i={};for(var n in e){var a=e[n];s.isEqual(t[n],a)||(i[n]=a)}return s.size(i)?i:!1},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return s.clone(this._previousAttributes)},fetch:function(e){e=s.extend({parse:!0},e);var t=this,i=e.success;return e.success=function(s){var n=e.parse?t.parse(s,e):s;return t.set(n,e)?(i&&i.call(e.context,t,s,e),void t.trigger("sync",t,s,e)):!1},M(this,e),this.sync("read",this,e)},save:function(e,t,i){var n;null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=s.extend({validate:!0,parse:!0},i);var a=i.wait;if(n&&!a){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;var r=this,o=i.success,h=this.attributes;i.success=function(e){r.attributes=h;var t=i.parse?r.parse(e,i):e;return a&&(t=s.extend({},n,t)),t&&!r.set(t,i)?!1:(o&&o.call(i.context,r,e,i),void r.trigger("sync",r,e,i))},M(this,i),n&&a&&(this.attributes=s.extend({},h,n));var A=this.isNew()?"create":i.patch?"patch":"update";"patch"!==A||i.attrs||(i.attrs=n);var g=this.sync(A,this,i);return this.attributes=h,g},destroy:function(e){e=e?s.clone(e):{};var t=this,i=e.success,n=e.wait,a=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(s){n&&a(),i&&i.call(e.context,t,s,e),t.isNew()||t.trigger("sync",t,s,e)};var r=!1;return this.isNew()?s.defer(e.success):(M(this,e),r=this.sync("delete",this,e)),n||a(),r},url:function(){var e=s.result(this,"urlRoot")||s.result(this.collection,"url")||N();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},s.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=s.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,s.extend(t,{validationError:i})),!1):!0}});var v={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};o(Q,v,"attributes");var y=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,s.extend({silent:!0},t))},B={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},b=function(e,t,s){s=Math.min(Math.max(s,0),e.length);var a,i=Array(e.length-s),n=t.length;for(a=0;a<i.length;a++)i[a]=e[a+s];for(a=0;n>a;a++)e[a+s]=t[a];for(a=0;a<i.length;a++)e[a+n+s]=i[a]};s.extend(y.prototype,g,{model:Q,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,s.extend({merge:!1},t,w))},remove:function(e,t){t=s.extend({},t);var i=!s.isArray(e);e=i?[e]:e.slice();var n=this._removeModels(e,t);return!t.silent&&n.length&&(t.changes={added:[],merged:[],removed:n},this.trigger("update",this,t)),i?n[0]:n},set:function(e,t){if(null!=e){t=s.extend({},B,t),t.parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var i=!s.isArray(e);e=i?[e]:e.slice();var n=t.at;null!=n&&(n=+n),n>this.length&&(n=this.length),0>n&&(n+=this.length+1);var d,_,a=[],r=[],o=[],h=[],A={},g=t.add,l=t.merge,c=t.remove,u=!1,p=this.comparator&&null==n&&t.sort!==!1,f=s.isString(this.comparator)?this.comparator:null;for(_=0;_<e.length;_++){d=e[_];var m=this.get(d);if(m){if(l&&d!==m){var Q=this._isModel(d)?d.attributes:d;t.parse&&(Q=m.parse(Q,t)),m.set(Q,t),o.push(m),p&&!u&&(u=m.hasChanged(f))}A[m.cid]||(A[m.cid]=!0,a.push(m)),e[_]=m}else g&&(d=e[_]=this._prepareModel(d,t),d&&(r.push(d),this._addReference(d,t),A[d.cid]=!0,a.push(d)))}if(c){for(_=0;_<this.length;_++)d=this.models[_],A[d.cid]||h.push(d);h.length&&this._removeModels(h,t)}var v=!1,y=!p&&g&&c;if(a.length&&y?(v=this.length!==a.length||s.some(this.models,function(e,t){return e!==a[t]}),this.models.length=0,b(this.models,a,0),this.length=this.models.length):r.length&&(p&&(u=!0),b(this.models,r,null==n?this.length:n),this.length=this.models.length),u&&this.sort({silent:!0}),!t.silent){for(_=0;_<r.length;_++)null!=n&&(t.index=n+_),d=r[_],d.trigger("add",d,this,t);(u||v)&&this.trigger("sort",this,t),(r.length||h.length||o.length)&&(t.changes={added:r,removed:h,merged:o},this.trigger("update",this,t))}return i?e[0]:e}},reset:function(e,t){t=t?s.clone(t):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,s.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,s.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,s.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return a.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var i=t.length;return s.isFunction(t)&&(t=s.bind(t,this)),1===i||s.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){e=s.extend({parse:!0},e);var t=e.success,i=this;return e.success=function(s){var n=e.reset?"reset":"set";i[n](s,e),t&&t.call(e.context,i,s,e),i.trigger("sync",i,s,e)},M(this,e),this.sync("read",this,e)},create:function(e,t){t=t?s.clone(t):{};var i=t.wait;if(e=this._prepareModel(e,t),!e)return!1;i||this.add(e,t);var n=this,a=t.success;return t.success=function(e,t,s){i&&n.add(e,s),a&&a.call(s.context,e,t,s)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?s.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_removeModels:function(e,t){for(var s=[],i=0;i<e.length;i++){var n=this.get(e[i]);if(n){var a=this.indexOf(n);this.models.splice(a,1),this.length--,delete this._byId[n.cid];var r=this.modelId(n.attributes);null!=r&&delete this._byId[r],t.silent||(t.index=a,n.trigger("remove",n,this,t)),s.push(n),this._removeReference(n,t)}}return s},_isModel:function(e){return e instanceof Q},_addReference:function(e,t){this._byId[e.cid]=e;var s=this.modelId(e.attributes);null!=s&&(this._byId[s]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var s=this.modelId(e.attributes);null!=s&&delete this._byId[s],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,s,i){if(t){if(("add"===e||"remove"===e)&&s!==this)return;if("destroy"===e&&this.remove(t,i),"change"===e){var n=this.modelId(t.previousAttributes()),a=this.modelId(t.attributes);n!==a&&(null!=n&&delete this._byId[n],null!=a&&(this._byId[a]=t))}}this.trigger.apply(this,arguments)}});var I={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};o(y,I,"models");var E=t.View=function(e){this.cid=s.uniqueId("view"),s.extend(this,s.pick(e,C)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,C=["model","collection","el","id","attributes","className","tagName","events"];s.extend(E.prototype,g,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=s.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var i=e[t];if(s.isFunction(i)||(i=this[i]),i){var n=t.match(T);this.delegate(n[1],n[2],s.bind(i,this))}}return this},delegate:function(e,t,s){return this.$el.on(e+".delegateEvents"+this.cid,t,s),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,s){return this.$el.off(e+".delegateEvents"+this.cid,t,s),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(s.result(this,"el"));else{var e=s.extend({},s.result(this,"attributes"));this.id&&(e.id=s.result(this,"id")),this.className&&(e["class"]=s.result(this,"className")),this.setElement(this._createElement(s.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,i,n){var a=x[e];s.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var r={type:a,dataType:"json"};if(n.url||(r.url=s.result(i,"url")||N()),null!=n.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(n.attrs||i.toJSON(n))),n.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),n.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){r.type="POST",n.emulateJSON&&(r.data._method=a);var o=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",a),o?o.apply(this,arguments):void 0}}"GET"===r.type||n.emulateJSON||(r.processData=!1);var h=n.error;n.error=function(e,t,s){n.textStatus=t,n.errorThrown=s,h&&h.call(n.context,e,t,s)};var A=n.xhr=t.ajax(s.extend(r,n));return i.trigger("request",i,A,n),A};var x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},F=/\((.*?)\)/g,D=/(\(\?)?:\w+/g,k=/\*\w+/g,L=/[\-{}\[\]+?.,\\\^$|#\s]/g;s.extend(S.prototype,g,{initialize:function(){},route:function(e,i,n){s.isRegExp(e)||(e=this._routeToRegExp(e)),s.isFunction(i)&&(n=i,i=""),n||(n=this[i]);var a=this;return t.history.route(e,function(s){var r=a._extractParameters(e,s);a.execute(n,r,i)!==!1&&(a.trigger.apply(a,["route:"+i].concat(r)),a.trigger("route",i,r),t.history.trigger("route",a,i,r))}),this},execute:function(e,t,s){e&&e.apply(this,t)},navigate:function(e,s){return t.history.navigate(e,s),this},_bindRoutes:function(){if(this.routes){this.routes=s.result(this,"routes");for(var e,t=s.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(L,"\\$&").replace(F,"(?:$1)?").replace(D,function(e,t){return t?e:"([^/?]+)"}).replace(k,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return s.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var j=t.History=function(){this.handlers=[],this.checkUrl=s.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,R=/^\/+|\/+$/g,H=/#.*$/;j.started=!1,s.extend(j.prototype,g,{interval:50,atRoot:function(){var e=this.location.pathname.replace(/[^\/]$/,"$&/");return e===this.root&&!this.getSearch()},matchRoot:function(){var e=this.decodeFragment(this.location.pathname),t=e.slice(0,this.root.length-1)+"/";return t===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(P,"")},start:function(e){if(j.started)throw new Error("Backbone.history has already been started");if(j.started=!0,this.options=s.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(R,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,n=i.insertBefore(this.iframe,i.firstChild).contentWindow;n.document.open(),n.document.close(),n.location.hash="#"+this.fragment}var a=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};return this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?a("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),j.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return this.matchRoot()?(e=this.fragment=this.getFragment(e),s.some(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})):!1},navigate:function(e,t){if(!j.started)return!1;t&&t!==!0||(t={trigger:!!t}),e=this.getFragment(e||"");var s=this.root;(""===e||"?"===e.charAt(0))&&(s=s.slice(0,-1)||"/");var i=s+e;if(e=this.decodeFragment(e.replace(H,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var n=this.iframe.contentWindow;t.replace||(n.document.open(),n.document.close()),this._updateHash(n.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,s){if(s){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new j;var O=function(e,t){var n,i=this;return n=e&&s.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},s.extend(n,i,t),n.prototype=s.create(i.prototype,e),n.prototype.constructor=n,n.__super__=i.prototype,n};Q.extend=y.extend=S.extend=E.extend=j.extend=O;var N=function(){throw new Error('A "url" property or function must be specified')},M=function(e,t){var s=t.error;t.error=function(i){s&&s.call(t.context,e,i,t),e.trigger("error",e,i,t)}};return t});