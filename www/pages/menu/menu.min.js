function menu(){this.page_infos=null,this._is_on_drag=!1,this.init(),this.replace_request=void 0,_okg=this}var _okg=null;menu.prototype.init=function(){TweenMax.to($("#backbutton"),.5,{scaleX:0,scaleY:0,onComplete:function(){$("#backbutton").css("display","none")}}),TweenMax.to($(".app_content"),.5,{backgroundColor:utilities.colorLuminance(colors.grey,.5)}),TweenMax.to($("#backbutton"),.5,{backgroundColor:utilities.colorLuminance(colors.grey,.5)}),this.load_infos()},menu.prototype.load_infos=function(){$.ajax({dataType:"json",url:"./pages/menu/pages_menu.json",data:{},success:function(t){_okg.page_infos=t,_okg.display_bricks()}})},menu.prototype.check_bricks=function(){if(void 0===$(".menu_content"))return!1;if($(".menu_content").position().left>0)for(var t=(n=$(".menu_content").find(".menu_screen").eq(0)).find(".brick").eq(0).position().left,e=0;e<n.find(".brick").length;e++)n.find(".brick").eq(e).position().left===t&&n.find(".brick").eq(e).css({left:-$(".menu_content").position().left+"px",width:n.find(".brick").eq(e+1).offset().left});if($(".menu_content").position().left<-($(".menu_content").width()-window.innerWidth)){var n;for(t=(n=$(".menu_content").find(".menu_screen").eq($(".menu_content").find(".menu_screen").length-1)).find(".brick").eq(n.find(".brick").length-1).offset().left,e=0;e<n.find(".brick").length;e++)n.find(".brick").eq(e).offset().left===t&&n.find(".brick").eq(e).css({width:window.innerWidth-t})}void 0!==_okg.replace_request&&(_okg.replace_request=requestAnimationFrame(_okg.check_bricks))},menu.prototype.display_bricks=function(){$(".menu_content").html("");var t=this;$.each(_.keys(this.page_infos),function(e,n){$(".menu_content").append('<div class="menu_screen" id="screen_'+n+'" style="float:left;"></div>'),t.display_apps(n)});$(".menu_screen").width(window.innerWidth),$(".menu_content").width(window.innerWidth*$(".menu_screen").length+1),$(".app_content").append('<div class="left_arrow"></div>'),$(".app_content").append('<div class="right_arrow"></div>'),t.slider=new slider($(".app_content"),$(".menu_content"),$(".menu_screen"),0,t.slider,{start_drag:function(e){t._is_on_drag=!0,t.replace_request=window.requestAnimationFrame(t.check_bricks)},stop_drag:function(t){},dragging:function(t){},end_drag:function(e){window.cancelAnimationFrame(t.replace_request),t.replace_request=void 0,t._is_on_drag=!1}}),$(".menu_content").css("left",-window.innerWidth*navigation._last_page_menu+"px")},menu.prototype.display_apps=function(t){var e=this;$.each(_.keys(this.page_infos[t]),function(n,i){var o=e.page_infos[t][i];o.position=positions[_.keys(e.page_infos[t]).length][n],o.id=t+"_"+i;var a=_.template($("#brick_template").html());$("#screen_"+t).append(a(o)),TweenMax.set($("#"+t+"_"+i),{scaleX:0,scaleY:0}),TweenMax.to($("#"+t+"_"+i),.4,{scaleX:1,scaleY:1,delay:n/10,ease:Quart.easeOut}),$("#"+t+"_"+i+" .screen_center").css({width:"100%",height:"100%"}),$("#"+t+"_"+i+" .screen_center").load("./pages/"+o.name+"/images/game_preview.svg",function(){$("#"+t+"_"+i+" .screen_center svg").css({width:"100%",height:"100%"}),$("#"+t+"_"+i+" .screen_center svg #shadow").attr("fill",$("#"+t+"_"+i).attr("data-color"))})}),"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0?$(".brick").off("touchend").on("touchend",function(t){e.slider.launched=!0,navigation.set_update_events(),e._is_on_drag?e.slider.launched=!1:(audio_manager.play_sound("menu_hit",0,function(){}),e.open_game($(this)))}):$(".brick").off("click").on("click",function(t){e.slider.launched=!0,navigation.set_update_events(),e._is_on_drag?e.slider.launched=!1:(audio_manager.play_sound("menu_hit",0,function(){}),e.open_game($(this)))})},menu.prototype.open_game=function(t){t.parent();var e=t,n=t.attr("data-name");t.css("z-index","99"),$.each(t.parent().find(".brick"),function(t,i){if($(this).attr("id")!=e.attr("id")){var o={left:0,top:$(this).position().top,width:$(this).width(),height:$(this).height()};$(this).position().left<e.position().left?o.left=-$(this).width()+"px":$(this).position().left==e.position().left?($(this).position().top<e.position().top?o.top=-$(this).height()+"px":o.top=window.innerHeight+"px",o.left=0,o.width="100%"):o.left=window.innerWidth+"px",$(this).position().top==e.position().top&&(o.top=0,o.height="100%"),TweenMax.to($(this),.7,{css:o,ease:Power4.easeOut,delay:.2})}else navigation._current_interface_color=$(this).css("background-color"),TweenMax.to($(this).find("svg"),.2,{opacity:0}),TweenMax.to($(this),.7,{css:{width:"100%",height:"100%",top:0,left:0},delay:.2,onComplete:function(){navigation.router.navigate("page/"+n,{trigger:!0,replace:!0})},ease:Power4.easeOut})}),TweenMax.to($(".app_content"),.5,{backgroundColor:t.attr("data-color")}),TweenMax.to($("#backbutton"),.5,{backgroundColor:t.attr("data-color")})},menu.prototype.get_picture_uri=function(t){return"../../pages/"+t+"/images/"+t.png},menu.prototype.pause=function(){},menu.prototype.play=function(){},menu.prototype.destroy=function(t){_okg.slider.destroy(),$(".brick").off("touchend, click"),t()};var positions={1:[{width:"100%",height:"100%",left:0,top:0}],2:[{width:"40%",height:"100%",left:0,top:0},{width:"60%",height:"100%",left:"40%",top:0}],3:[{width:"40%",height:"100%",left:0,top:0},{width:"60%",height:"50%",left:"40%",top:0},{width:"60%",height:"50%",left:"40%",top:"50%"}],4:[{width:"40%",height:"100%",left:0,top:0},{width:"60%",height:"50%",left:"40%",top:0},{width:"30%",height:"50%",left:"40%",top:"50%"},{width:"30%",height:"50%",left:"70%",top:"50%"}],5:[{width:"25%",height:"50%",left:0,top:0},{width:"25%",height:"50%",left:0,top:"50%"},{width:"50%",height:"100%",left:"25%",top:0},{width:"25%",height:"50%",left:"75%",top:0},{width:"25%",height:"50%",left:"75%",top:"50%"}],6:[{width:"40%",height:"60%",left:0,top:0},{width:"40%",height:"40%",left:0,top:"60%"},{width:"30%",height:"50%",left:"40%",top:0},{width:"30%",height:"50%",left:"70%",top:0},{width:"30%",height:"50%",left:"40%",top:"50%"},{width:"30%",height:"50%",left:"70%",top:"50%"}]};