function node_utilities(){}node_utilities.prototype.init_device=function(){this.os=require("os");this.gui=require("nw.gui");this.win=gui.Window.get();this.platform=require("./components/platform")};node_utilities.prototype.get_user_ip=function(b){var c=[];var a=this.os.networkInterfaces();Object.keys(a).forEach(function(e){var d=0;a[e].forEach(function(f){if("IPv4"!==f.family||f.internal!==false){return}if(d>=1){c.push({ifname:d,iface:f})}else{c.push({ifname:e,iface:f})}})});b(c)};node_utilities.prototype.get_user_home=function(){return process.env[(process.platform=="win32")?"USERPROFILE":"HOME"]};node_utilities.prototype.init_fileSystem=function(){this.fs=require("fs");this.path=require("path")};node_utilities.prototype.create_folder=function(a,b){if(typeof this.fs==="undefined"){this.init_fileSystem()}this.fs.mkdir(this.get_user_home()+"/"+a,511,true,function(c){if(c){b(c)}else{b(a)}})};node_utilities.prototype.delete_picture=function(a,b){if(typeof this.fs==="undefined"){this.init_fileSystem()}if(!this.fs.existsSync(this.get_user_home()+"/okaoka/pictures/"+a)){this.fs.openSync(this.get_user_home()+"/okaoka/pictures/"+a,"wx")}this.fs.unlink(this.get_user_home()+"/okaoka/pictures/"+a,function(){callBack()})};node_utilities.prototype.save_picture=function(e,b,a,d){if(typeof require==="undefined"){return{error:"require is not defined"}}if(typeof this.fs==="undefined"){this.init_fileSystem()}this.create_folder("okaoka",function(){});this.create_folder("okaoka/pictures",function(){});var c=new Date().getTime()+"_"+b+"_"+Math.random()*1000+".png";this.write_file(this.get_user_home()+"/okaoka/pictures",c,e,"binary",function(f){});this.insert_datas("pictures",{filename:{type:"TEXT",value:c},votes:{type:"TEXT",value:"0"},saved:{type:"TEXT",value:"false"}},function(f){d(f)})};node_utilities.prototype.write_file=function(d,b,f,c,e){if(typeof c==="undefined"){c="binary"}if(typeof this.fs==="undefined"){this.init_fileSystem()}var a=f.replace(/^data:image\/png;base64,/,"");this.fs.writeFile(d+"/"+b,a,"base64",function(g){e(g);if(g){throw g}})};node_utilities.prototype.read_file=function(a,b){if(typeof this.fs==="undefined"){this.init_fileSystem()}this.fs.readFile(this.get_user_home()+a,"utf8",function(c,d){if(c){b(c,d);throw c}b(c,d)})};node_utilities.prototype.open_database=function(){this.db=openDatabase("okaoka","1.0","okaoka database",2*1024*1024)};node_utilities.prototype.insert_datas=function(c,a,e){this.open_database();var b="";var d="";$.each(_.keys(a),function(g,f){b+=f;d+='"'+a[f].value+'"';if(g<_.keys(a).length-1){b+=", ";d+=", "}});this.db.transaction(function(f){f.executeSql("CREATE TABLE IF NOT EXISTS "+c+" (id unique, "+b+")");f.executeSql("INSERT INTO "+c+" ("+b+") VALUES ("+d+")")});this.close_database();e({code:200,status:"success"})};node_utilities.prototype.get_datas=function(e,a,f){var d=false;this.open_database();var c="";if(typeof a.where!=="undefined"){$.each(_.keys(a.where),function(h,g){if(c===""){c=" WHERE "+g+"='"+a.where[g]+"'"}else{c+=" AND "+g+"='"+a.where[g]+"'"}})}var b="";if(typeof a.limit!=="undefined"){b=" LIMIT "+a.limit;delete a.limit}this.db.transaction(function(g){g.executeSql("SELECT * FROM "+e+""+c+""+b,[],function(k,m){var j=m.rows.length,l;var h=[];for(l=0;l<j;l++){h.push(m.rows.item(l))}f({code:200,status:"success",datas:h});d=true})});this.close_database();setTimeout(function(){if(!d){f({code:300,status:"error",message:"La base de donnée ne répond pas."})}},5000)};node_utilities.prototype.execute=function(b,c){var a=false;this.open_database();this.db.transaction(function(d){d.executeSql(b,[],function(g,j){var f=j.rows.length,h;var e=[];for(h=0;h<f;h++){e.push(j.rows.item(h))}c({code:200,status:"success",datas:e});a=true})});this.close_database();setTimeout(function(){if(!a){c({code:300,status:"error",message:"La base de donnée ne répond pas."})}},5000)};node_utilities.prototype.update_saved_datas=function(a,b){this.execute("UPDATE "+a+" SET saved = 'true'",function(c){b(c)})};node_utilities.prototype.close_database=function(){};